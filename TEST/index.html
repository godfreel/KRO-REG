<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script type="text/javascript" scr="video.js"></script>
	<title></title>
</head>
<body>

<div id="player"></div>

</body>

<script type="text/javascript">

/**
  * Options should have following attributes:
  * 
  * target - ID of node in which SVG animation sould should be passed 
  *
  * movies - an array of objects representing svg file and duration of animation.
  * Each object should have following structure:
  *  	{
  * 		src: "path_to_svg",
  * 		duration: milliseconds
  * 	}
  *
  *	
  Example:
  	var svgPlayer = new Player({
		target: "YOUR_TARGET_ID",
		movies: [
			{
				src: "main.svg",
				duration: 6500
			},
			{
				src: "main1.svg",
				duration: 6500
			}
		]
	});

	//start play animation
	svgPlayer.start();

  */
	var Player = function(options) {

		var API = {};

		var default_options = {
	        width: "800px",
	        height: "400px",
	        movies: []
	    };
	    var it = 0;
	    var o = API.o = jQuery.extend({}, default_options, options || {});
	    var movies_count = o.movies.length;

	    var target;
	    var player;
	    

	    function init() {

	    	if(o.target) {
 				target = jQuery('#' + o.target);
	    	} else {
	    		throw new Error('target are not provided');
	    	}

	    	player = document.createElement("object");
	    	player.id = "svgContent";
			player.type = "image/svg+xml";
			player.width = o.width;
			player.height = o.height;

			target.append(player);
	    }

	    /**
	      * execute this function for start play animation
	      */
	    API.start = function() {

	    	function scheduleNext(src, duration) {

				setTimeout(function() {

					//change src of svg-file
					player.data = o.movies[it].src;
					
					//reset iterator if needed
					if(++it >= o.movies.length)	{
						it = 0;
					}

					//calculate right duration
					var nextDuration = it ? o.movies[it-1].duration : o.movies[o.movies.length - 1].duration;

					//schedule next execution
					scheduleNext(o.movies[it].src, nextDuration);
				}, duration);
	    	}

	    	scheduleNext(o.movies[it].src, 0);
	    }

	    init();

	    return API;
	}

var player = new Player({
	target: "player",
	movies: [
		{
			src: "krisy.svg",
			duration: 6000
		},
		{
			src: "nos.svg",
			duration: 3000
		},
		{
			src: "main1.svg",
			duration: 10000
		}
	]
});

player.start();
</script>



</html>